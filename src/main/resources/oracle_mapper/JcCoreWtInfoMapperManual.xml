<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xwkj.ygjces.Mapper_oracle.JcCoreWtInfoMapperManual" >
  <resultMap id="BaseResultMap" type="com.xwkj.ygjces.model.JcCoreWtInfo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 29 14:16:39 CST 2019.
    -->
    <id column="WT_ID" property="wtId" jdbcType="VARCHAR" />
    <result column="WT_NUM" property="wtNum" jdbcType="VARCHAR" />
    <result column="CUSTOMER_ID" property="customerId" jdbcType="VARCHAR" />
    <result column="DATACID" property="datacid" jdbcType="VARCHAR" />
    <result column="DATANAME" property="dataname" jdbcType="VARCHAR" />
    <result column="YWDEPARTMENTID" property="ywdepartmentid" jdbcType="VARCHAR" />
    <result column="YWDEPARTMENT" property="ywdepartment" jdbcType="VARCHAR" />
    <result column="DESTDEPARTMENTID" property="destdepartmentid" jdbcType="VARCHAR" />
    <result column="DESTDEPARTMENT" property="destdepartment" jdbcType="VARCHAR" />
    <result column="DESTUSERID" property="destuserid" jdbcType="VARCHAR" />
    <result column="DESTUSER" property="destuser" jdbcType="VARCHAR" />
    <result column="WT_UNIT_ID" property="wtUnitId" jdbcType="VARCHAR" />
    <result column="WT_UNIT" property="wtUnit" jdbcType="VARCHAR" />
    <result column="WT_MAN" property="wtMan" jdbcType="VARCHAR" />
    <result column="WT_MAN_TEL" property="wtManTel" jdbcType="VARCHAR" />
    <result column="WT_UNIT_ADDRESS" property="wtUnitAddress" jdbcType="VARCHAR" />
    <result column="WT_UNIT_POSTALCODE" property="wtUnitPostalcode" jdbcType="VARCHAR" />
    <result column="WT_UNIT_PERSON" property="wtUnitPerson" jdbcType="VARCHAR" />
    <result column="WT_UNIT_TEL" property="wtUnitTel" jdbcType="VARCHAR" />
    <result column="CONTRACT_CODE" property="contractCode" jdbcType="VARCHAR" />
    <result column="GC_PAYMENT" property="gcPayment" jdbcType="VARCHAR" />
    <result column="GC_CODE" property="gcCode" jdbcType="VARCHAR" />
    <result column="GC_NAME" property="gcName" jdbcType="VARCHAR" />
    <result column="GC_SUB" property="gcSub" jdbcType="VARCHAR" />
    <result column="GC_ADDRESS" property="gcAddress" jdbcType="VARCHAR" />
    <result column="GC_AREA" property="gcArea" jdbcType="VARCHAR" />
    <result column="JS_UNIT_ID" property="jsUnitId" jdbcType="VARCHAR" />
    <result column="JS_UNIT" property="jsUnit" jdbcType="VARCHAR" />
    <result column="KC_UNIT_ID" property="kcUnitId" jdbcType="VARCHAR" />
    <result column="KC_UNIT" property="kcUnit" jdbcType="VARCHAR" />
    <result column="SG_CODE" property="sgCode" jdbcType="VARCHAR" />
    <result column="SG_UNIT_ID" property="sgUnitId" jdbcType="VARCHAR" />
    <result column="SG_UNIT" property="sgUnit" jdbcType="VARCHAR" />
    <result column="GC_JIANDU_ID" property="gcJianduId" jdbcType="VARCHAR" />
    <result column="JD_UNIT_ID" property="jdUnitId" jdbcType="VARCHAR" />
    <result column="JD_UNIT" property="jdUnit" jdbcType="VARCHAR" />
    <result column="JIANDUKE" property="jianduke" jdbcType="VARCHAR" />
    <result column="JD_MAN_ID" property="jdManId" jdbcType="VARCHAR" />
    <result column="JD_MAN" property="jdMan" jdbcType="VARCHAR" />
    <result column="JD_MAN_TEL" property="jdManTel" jdbcType="VARCHAR" />
    <result column="JL_UNIT_ID" property="jlUnitId" jdbcType="VARCHAR" />
    <result column="JL_UNIT" property="jlUnit" jdbcType="VARCHAR" />
    <result column="JZ_MAN_ID" property="jzManId" jdbcType="VARCHAR" />
    <result column="JZ_MAN" property="jzMan" jdbcType="VARCHAR" />
    <result column="JZ_MAN_TEL" property="jzManTel" jdbcType="VARCHAR" />
    <result column="JZ_UNIT_ID" property="jzUnitId" jdbcType="VARCHAR" />
    <result column="JZ_UNIT" property="jzUnit" jdbcType="VARCHAR" />
    <result column="WT_DATE" property="wtDate" jdbcType="TIMESTAMP" />
    <result column="YY_MAN_ID" property="yyManId" jdbcType="VARCHAR" />
    <result column="YY_MAN" property="yyMan" jdbcType="VARCHAR" />
    <result column="SFMON" property="sfmon" jdbcType="VARCHAR" />
    <result column="DISCOUNT_MONEY" property="discountMoney" jdbcType="VARCHAR" />
    <result column="REAL_MONEY" property="realMoney" jdbcType="VARCHAR" />
    <result column="INVOICE_MONEY" property="invoiceMoney" jdbcType="VARCHAR" />
    <result column="TRANSFER_MONEY" property="transferMoney" jdbcType="VARCHAR" />
    <result column="DIRECT_MONEY" property="directMoney" jdbcType="VARCHAR" />
    <result column="REALLOCATE_MONEY" property="reallocateMoney" jdbcType="VARCHAR" />
    <result column="ACCOUNT_NUMBER" property="accountNumber" jdbcType="VARCHAR" />
    <result column="BEIZHU" property="beizhu" jdbcType="VARCHAR" />
    <result column="JS_STATUS" property="jsStatus" jdbcType="VARCHAR" />
    <result column="REMAINING_MONEY" property="remainingMoney" jdbcType="VARCHAR" />
    <result column="BACK_MONEY" property="backMoney" jdbcType="VARCHAR" />
    <result column="TOZH_MONEY" property="tozhMoney" jdbcType="VARCHAR" />
    <result column="ALREADY_MONEY" property="alreadyMoney" jdbcType="VARCHAR" />
    <result column="WT_STATUS" property="wtStatus" jdbcType="VARCHAR" />
    <result column="XN_MONEY" property="xnMoney" jdbcType="VARCHAR" />
    <result column="WT_JCCS" property="wtJccs" jdbcType="VARCHAR" />
    <result column="JZ_JZMJ" property="jzJzmj" jdbcType="VARCHAR" />
    <result column="JZ_JZXZ" property="jzJzxz" jdbcType="VARCHAR" />
    <result column="JZ_JZLC" property="jzJzlc" jdbcType="VARCHAR" />
    <result column="SG_UNIT_SUB" property="sgUnitSub" jdbcType="VARCHAR" />
    <result column="OLD_ORG" property="oldOrg" jdbcType="VARCHAR" />
    <result column="GC_GCPQ" property="gcGcpq" jdbcType="VARCHAR" />
    <result column="GC_XMJL" property="gcXmjl" jdbcType="VARCHAR" />
    <result column="GC_ZJ" property="gcZj" jdbcType="VARCHAR" />
    <result column="OL_WT_NUM" property="olWtNum" jdbcType="VARCHAR" />
    <result column="STATION_ID" property="stationId" jdbcType="VARCHAR" />
    <result column="JL_MAN" property="jlMan" jdbcType="VARCHAR" />
    <result column="PD_PASS_CODE" property="pdPassCode" jdbcType="VARCHAR" />
    <result column="JZFS" property="jzfs" jdbcType="VARCHAR" />
    <result column="WT_REG_ID" property="wtRegId" jdbcType="VARCHAR" />
    <result column="WT_REG_NAME" property="wtRegName" jdbcType="VARCHAR" />
    <result column="SJ_UNIT" property="sjUnit" jdbcType="VARCHAR" />
    <result column="CY_UNIT" property="cyUnit" jdbcType="VARCHAR" />
    <result column="CY_MAN" property="cyMan" jdbcType="VARCHAR" />
    <result column="CY_MAN_ID" property="cyManId" jdbcType="VARCHAR" />
    <result column="JGLX" property="jglx" jdbcType="VARCHAR" />
    <result column="JGCS" property="jgcs" jdbcType="VARCHAR" />
    <result column="CY_PLACE" property="cyPlace" jdbcType="VARCHAR" />
    <result column="PROVINCE" property="province" jdbcType="VARCHAR" />
    <result column="CITY" property="city" jdbcType="VARCHAR" />
    <result column="AREA" property="area" jdbcType="VARCHAR" />
    <result column="GC_AREA_CODE" property="gcAreaCode" jdbcType="VARCHAR" />
    <result column="GC_TYPE" property="gcType" jdbcType="VARCHAR" />
    <result column="GC_NUM" property="gcNum" jdbcType="VARCHAR" />
    <result column="SJ_UNIT_ID" property="sjUnitId" jdbcType="VARCHAR" />
    <result column="CHOUYANGREN" property="chouyangren" jdbcType="VARCHAR" />
    <result column="FKDW" property="fkdw" jdbcType="VARCHAR" />
    <result column="CHOUYANGREN_CODE" property="chouyangrenCode" jdbcType="VARCHAR" />
    <result column="CONTRACT_CODE_INTERACTION" property="contractCodeInteraction" jdbcType="VARCHAR" />
    <result column="FKDW_NUM" property="fkdwNum" jdbcType="VARCHAR" />
    <result column="LASTUPDATE" property="lastupdate" jdbcType="TIMESTAMP" />
    <result column="SG" property="sg" jdbcType="VARCHAR" />
    <result column="WT_REG_DATE" property="wtRegDate" jdbcType="TIMESTAMP" />
    <result column="MODULENAME" property="modulename" jdbcType="VARCHAR" />
    <result column="JC_TASK_JS_MAN_ID" property="jcTaskJsManId" jdbcType="VARCHAR" />
    <result column="JC_TASK_JS_MAN" property="jcTaskJsMan" jdbcType="VARCHAR" />
    <result column="JC_TASK_REG_MAN_ID" property="jcTaskRegManId" jdbcType="VARCHAR" />
    <result column="JC_TASK_REG_MAN" property="jcTaskRegMan" jdbcType="VARCHAR" />
    <result column="JC_TASK_REG_DATE" property="jcTaskRegDate" jdbcType="TIMESTAMP" />
    <result column="JC_TASK_STATUS" property="jcTaskStatus" jdbcType="VARCHAR" />
    <result column="JC_TASK_SH_MAN_ID" property="jcTaskShManId" jdbcType="VARCHAR" />
    <result column="JC_TASK_SH_MAN" property="jcTaskShMan" jdbcType="VARCHAR" />
    <result column="IS_PRODUCE_GD" property="isProduceGd" jdbcType="VARCHAR" />
    <result column="PRODUCE_GD_MAN_ID" property="produceGdManId" jdbcType="VARCHAR" />
    <result column="PRODUCE_GD_MAN" property="produceGdMan" jdbcType="VARCHAR" />
    <result column="PRODUCE_GD_DATE" property="produceGdDate" jdbcType="TIMESTAMP" />
    <result column="BGJFFS" property="bgjffs" jdbcType="VARCHAR" />
    <result column="YW_MAN" property="ywMan" jdbcType="VARCHAR" />
    <result column="YW_MAN_ID" property="ywManId" jdbcType="VARCHAR" />
    <result column="YWQY" property="ywqy" jdbcType="VARCHAR" />
    <result column="JS_MAN" property="jsMan" jdbcType="VARCHAR" />
    <result column="JS_MAN_TEL" property="jsManTel" jdbcType="VARCHAR" />
    <result column="JL_MAN_TEL" property="jlManTel" jdbcType="VARCHAR" />
    <result column="KC_MAN" property="kcMan" jdbcType="VARCHAR" />
    <result column="KC_MAN_TEL" property="kcManTel" jdbcType="VARCHAR" />
    <result column="SG_MAN" property="sgMan" jdbcType="VARCHAR" />
    <result column="SG_MAN_TEL" property="sgManTel" jdbcType="VARCHAR" />
    <result column="GC_XMJL_TEL" property="gcXmjlTel" jdbcType="VARCHAR" />
    <result column="SJ_MAN" property="sjMan" jdbcType="VARCHAR" />
    <result column="SJ_MAN_TEL" property="sjManTel" jdbcType="VARCHAR" />
    <result column="JC_TASK_XD_MAN_ID" property="jcTaskXdManId" jdbcType="VARCHAR" />
    <result column="JC_TASK_XD_MAN" property="jcTaskXdMan" jdbcType="VARCHAR" />
    <result column="JC_TASK_XD_DATE" property="jcTaskXdDate" jdbcType="TIMESTAMP" />
    <result column="SK_NUMBER" property="skNumber" jdbcType="VARCHAR" />
    <result column="XC_WT_NUM" property="xcWtNum" jdbcType="VARCHAR" />
    <result column="JCDD" property="jcdd" jdbcType="VARCHAR" />
    <result column="SEND_BACK_REASON" property="sendBackReason" jdbcType="VARCHAR" />
    <result column="SEND_BACK_MAN_ID" property="sendBackManId" jdbcType="VARCHAR" />
    <result column="SEND_BACK_MAN" property="sendBackMan" jdbcType="VARCHAR" />
    <result column="GC_BEIZHU" property="gcBeizhu" jdbcType="VARCHAR" />
    <result column="CAR_TYPE" property="carType" jdbcType="VARCHAR" />
    <result column="YW_SOURCE" property="ywSource" jdbcType="VARCHAR" />
    <result column="BLIND_NUMBER" property="blindNumber" jdbcType="VARCHAR" />
    <result column="JC_DATE" property="jcDate" jdbcType="TIMESTAMP" />
    <result column="GC_JGCODE" property="gcJgcode" jdbcType="VARCHAR" />
    <result column="CONTRACT_PHASE" property="contractPhase" jdbcType="VARCHAR" />
    <result column="WT_SERIAL_NUM" property="wtSerialNum" jdbcType="VARCHAR" />
    <result column="PQT_PLAN_NO" property="pqtPlanNo" jdbcType="VARCHAR" />
    <result column="CONTRACT_ID" property="contractId" jdbcType="VARCHAR" />
    <result column="JC_TASK_TJ_MAN_ID" property="jcTaskTjManId" jdbcType="VARCHAR" />
    <result column="JC_TASK_TJ_MAN" property="jcTaskTjMan" jdbcType="VARCHAR" />
    <result column="JC_TASK_TJ_DATE" property="jcTaskTjDate" jdbcType="TIMESTAMP" />
  </resultMap>
  <resultMap id="ManualMap" type="com.xwkj.ygjces.model.DateAndCount">
    <result column="date" property="date" jdbcType="VARCHAR"></result>
    <result column="val" property="count" jdbcType="BIGINT"></result>
  </resultMap>
  <resultMap id="WtInfoMap" type="com.xwkj.ygjces.controller.vo.JcCoreWtInfoVo">
    <id column="WT_ID" property="wtId" jdbcType="VARCHAR" />
    <result column="WT_NUM" property="wtNum" jdbcType="VARCHAR" />
    <result column="WT_DATE" property="wtDate" jdbcType="TIMESTAMP" />
    <result column="WT_UNIT" property="wtUnit" jdbcType="VARCHAR" />
    <result column="xm_name" property="xmName" jdbcType="VARCHAR" />
    <result column="CONTRACT_CODE" property="contractCode" jdbcType="VARCHAR" />
    <result column="REAL_MONEY" property="realMoney" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Jul 29 14:16:39 CST 2019.
    -->
    WT_ID, WT_NUM, CUSTOMER_ID, DATACID, DATANAME, YWDEPARTMENTID, YWDEPARTMENT, DESTDEPARTMENTID, 
    DESTDEPARTMENT, DESTUSERID, DESTUSER, WT_UNIT_ID, WT_UNIT, WT_MAN, WT_MAN_TEL, WT_UNIT_ADDRESS, 
    WT_UNIT_POSTALCODE, WT_UNIT_PERSON, WT_UNIT_TEL, CONTRACT_CODE, GC_PAYMENT, GC_CODE, 
    GC_NAME, GC_SUB, GC_ADDRESS, GC_AREA, JS_UNIT_ID, JS_UNIT, KC_UNIT_ID, KC_UNIT, SG_CODE, 
    SG_UNIT_ID, SG_UNIT, GC_JIANDU_ID, JD_UNIT_ID, JD_UNIT, JIANDUKE, JD_MAN_ID, JD_MAN, 
    JD_MAN_TEL, JL_UNIT_ID, JL_UNIT, JZ_MAN_ID, JZ_MAN, JZ_MAN_TEL, JZ_UNIT_ID, JZ_UNIT, 
    WT_DATE, YY_MAN_ID, YY_MAN, SFMON, DISCOUNT_MONEY, REAL_MONEY, INVOICE_MONEY, TRANSFER_MONEY, 
    DIRECT_MONEY, REALLOCATE_MONEY, ACCOUNT_NUMBER, BEIZHU, JS_STATUS, REMAINING_MONEY, 
    BACK_MONEY, TOZH_MONEY, ALREADY_MONEY, WT_STATUS, XN_MONEY, WT_JCCS, JZ_JZMJ, JZ_JZXZ, 
    JZ_JZLC, SG_UNIT_SUB, OLD_ORG, GC_GCPQ, GC_XMJL, GC_ZJ, OL_WT_NUM, STATION_ID, JL_MAN, 
    PD_PASS_CODE, JZFS, WT_REG_ID, WT_REG_NAME, SJ_UNIT, CY_UNIT, CY_MAN, CY_MAN_ID, 
    JGLX, JGCS, CY_PLACE, PROVINCE, CITY, AREA, GC_AREA_CODE, GC_TYPE, GC_NUM, SJ_UNIT_ID, 
    CHOUYANGREN, FKDW, CHOUYANGREN_CODE, CONTRACT_CODE_INTERACTION, FKDW_NUM, LASTUPDATE, 
    SG, WT_REG_DATE, MODULENAME, JC_TASK_JS_MAN_ID, JC_TASK_JS_MAN, JC_TASK_REG_MAN_ID, 
    JC_TASK_REG_MAN, JC_TASK_REG_DATE, JC_TASK_STATUS, JC_TASK_SH_MAN_ID, JC_TASK_SH_MAN, 
    IS_PRODUCE_GD, PRODUCE_GD_MAN_ID, PRODUCE_GD_MAN, PRODUCE_GD_DATE, BGJFFS, YW_MAN, 
    YW_MAN_ID, YWQY, JS_MAN, JS_MAN_TEL, JL_MAN_TEL, KC_MAN, KC_MAN_TEL, SG_MAN, SG_MAN_TEL, 
    GC_XMJL_TEL, SJ_MAN, SJ_MAN_TEL, JC_TASK_XD_MAN_ID, JC_TASK_XD_MAN, JC_TASK_XD_DATE, 
    SK_NUMBER, XC_WT_NUM, JCDD, SEND_BACK_REASON, SEND_BACK_MAN_ID, SEND_BACK_MAN, GC_BEIZHU, 
    CAR_TYPE, YW_SOURCE, BLIND_NUMBER, JC_DATE, GC_JGCODE, CONTRACT_PHASE, WT_SERIAL_NUM, 
    PQT_PLAN_NO, CONTRACT_ID, JC_TASK_TJ_MAN_ID, JC_TASK_TJ_MAN, JC_TASK_TJ_DATE
  </sql>

  <select id="getMapCityAreaWtInfo" resultMap="WtInfoMap">
    SELECT t.wt_num,t.wt_date,t.wt_unit,p.xm_name,t.CONTRACT_CODE,t.real_money FROM JC_CORE_WT_INFO t
    left join JC_CORE_SAMPLE p on t.wt_num = p.wt_num
    <where>
      <if test="wt_num != null and wt_num != ''">
        and t.wt_num = #{wt_num}
      </if>
      <if test="city != '' and city != null">
        and t.city = #{city}
      </if>
      <if test="area != '' and area != null">
        and t.area = #{area}
      </if>
      <if test="startTime != null">
        AND t.wt_date <![CDATA[ >= ]]> #{startTime}
      </if>
      <if test="endTime != null">
        AND t.wt_date <![CDATA[ <= ]]> #{endTime}
      </if>
      <if test="startTime == null and endTime == null">
        AND EXTRACT (YEAR FROM t.wt_date) =  EXTRACT (YEAR FROM sysdate)
      </if>
    </where>

  </select>

  <select id="getMapCityAreaWtCount" resultType="Integer">
    SELECT count(*) FROM JC_CORE_WT_INFO
    <where>
      <if test="city != '' and city != null">
        and city = #{city}
      </if>
      <if test="area != '' and area != null">
        and area = #{area}
      </if>
      <if test="startTime != null">
        AND wt_date <![CDATA[ > ]]> #{startTime}
      </if>
      <if test="endTime != null">
        AND wt_date <![CDATA[ < ]]> #{endTime}
      </if>
      <if test="startTime == null and endTime == null">
        AND EXTRACT (YEAR FROM wt_date) =  EXTRACT (YEAR FROM sysdate)
      </if>
    </where>

  </select>

  <select id="getJcCoreWtInfoListByContractCode" resultMap="BaseResultMap">
    SELECT * FROM JC_CORE_WT_INFO jcwi where jcwi.contract_code = #{contractCode}
  </select>

  <select id="getJcCoreWtInfoByContractCode" resultMap="ManualMap">
    SELECT to_char(jcwi.wt_date,'yyyy-MM-dd') "date",COUNT(*) "val" FROM JC_CORE_WT_INFO jcwi WHERE jcwi.contract_code = #{contractCode} GROUP BY to_char(jcwi.wt_date,'yyyy-MM-dd') ORDER  BY to_char(jcwi.wt_date,'yyyy-MM-dd') ASC
  </select>


  <select id="getJcCoreWtInfoJsAmountByContractCode" resultType="java.lang.Long">
    SELECT count(*) FROM JC_CORE_WT_INFO jcwi where jcwi.contract_code = #{contractCode,jdbcType=VARCHAR} and js_status = '已结算'
  </select>

  <select id="getJcCoreWtInfoWjsAmountByContractCode" resultType="java.lang.Long">
    SELECT count(*) FROM JC_CORE_WT_INFO jcwi where jcwi.contract_code = #{contractCode,jdbcType=VARCHAR} and js_status = '未结算'
  </select>

  <select id="getJcCoreWtInfoWithContractInThisYear" resultMap="ManualMap">
    SELECT to_char(wt_date,'YYYY-MM') "date",COUNT(*) "val"
    from JC_CORE_WT_INFO
    where to_char(wt_date,'YYYY') = to_char(sysdate,'YYYY') and contract_code is NOT null
    group by to_char(wt_date,'YYYY-MM') order by to_char(wt_date,'YYYY-MM')
  </select>

  <select id="getJcCoreWtInfoWithoutContractInThisYear" resultMap="ManualMap">
    SELECT to_char(wt_date,'YYYY-MM') "date",COUNT(*) "val"
    from JC_CORE_WT_INFO
    where to_char(wt_date,'YYYY') = to_char(sysdate,'YYYY') and contract_code is null
    group by to_char(wt_date,'YYYY-MM') order by to_char(wt_date,'YYYY-MM')
  </select>

  <select id="getJcCoreWtInfoCountWithContractByDate" resultType="java.lang.Long">
    select count(*)
    from JC_CORE_WT_INFO
    where to_char(wt_date,'YYYY-MM') = to_char(#{date},'YYYY-MM') and contract_code is NOT null
  </select>

  <select id="getJcCoreWtInfoCountWithoutContractByDate" resultType="java.lang.Long">
    select count(*)
    from JC_CORE_WT_INFO
    where to_char(wt_date,'YYYY-MM') = to_char(#{date},'YYYY-MM') and contract_code is null
  </select>
  
  <select id="getJcCoreWtListInfoByDate" resultMap="BaseResultMap">
    select *
    from jc_core_wt_info jcwi
    where to_char(jcwi.wt_date,'YYYY-MM') = to_char(#{date},'YYYY-MM')
    <if test="wtNum != null and wtNum != ''">
      AND jcwi.WT_NUM like CONCAT (CONCAT('%' , #{wtNum}) , '%')
    </if>
    <if test="startTime != null">
      AND jcwi.wt_date <![CDATA[ > ]]> #{startTime}
    </if>
    <if test="endTime != null">
      AND jcwi.wt_date <![CDATA[ < ]]> #{endTime}
    </if>
    <if test="jsStatus != null and jsStatus != ''">
      AND jcwi.js_status = #{jsStatus}
    </if>
    <if test="contractCode != null and contractCode != ''">
      <if test="contractCode==1">
        AND jcwi.CONTRACT_CODE IS NOT NULL
      </if>
      <if test="contractCode==0">
        AND jcwi.CONTRACT_CODE IS NULL
      </if>
    </if>
  </select>


  <select id="selectWtRealMoneyWithOneDay" resultType="Integer">
    SELECT sum(to_number(real_money)) FROM JC_CORE_WT_INFO where trunc(wt_date,'dd') = trunc(sysdate,'dd') and wt_num is not null and js_status = '已结算'
  </select>

  <select id="selectWtRealMoneyWithOneMonth" resultType="Integer">
    SELECT sum(to_number(real_money)) FROM JC_CORE_WT_INFO where to_char(wt_date,'yyyy-dd') =  to_char(sysdate,'yyyy-dd') and wt_num is not null and js_status = '已结算'
  </select>

  <select id="selectWtCountWithOneDay" resultType="Integer">
    select count(1) from JC_CORE_WT_INFO where trunc(wt_date,'dd') = trunc(sysdate,'dd') and wt_num is not null
  </select>

  <select id="selectWtCountWithOneMonth" resultType="Integer">
    select count(1) from JC_CORE_WT_INFO where to_char(wt_date,'yyyy-dd') =  to_char(sysdate,'yyyy-dd') and wt_num is not null
  </select>

</mapper>